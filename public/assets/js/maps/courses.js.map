{"version":3,"sources":["node_modules/browser-pack/_prelude.js","source/js/courses.js","source/js/prepareSend.js","source/js/sendAjax.js","source/js/upload.js"],"names":[],"mappings":"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","file":"../courses.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import fileUpload from './upload';\r\nimport prepareSend from './prepareSend';\r\n\r\nconst formAddCourse = document.querySelector('#add-course');\r\nconst fileSelect = document.querySelector('#file-select');\r\n\r\n// this hack to prevent double data in db\r\n$( \"#add-btn\" ).unbind( \"click\" );\r\n$(\"#img-holder\").attr('data-content','Upload picture');\r\nfileSelect.addEventListener('change', function (e) { handleFileSelect(e);  prepareSendFile(e); });\r\nformAddCourse.addEventListener('submit', prepareSendCourse);\r\nformAddCourse.addEventListener('reset', (e) => { formAddCourse.style.display = \"none\"; });\r\n\r\nfunction handleFileSelect(evt) {\r\n  var f = evt.target.files[0];\r\n    var reader = new FileReader();\r\n          reader.onload = (function(theFile) {\r\n      return function(e) {          \r\n        $(\"#img-holder\").attr(\"style\",\"background-image: url(\"+e.target.result+\");\");\r\n        $(\"#img-holder\").attr('data-content','');\r\n        localStorage.setItem('img', e.target.result);\r\n      };\r\n    })(f);\r\n    reader.readAsDataURL(f);    \r\n}\r\n\r\nfunction prepareSendFile(e) {\r\n    e.preventDefault();\r\n    let resultContainer = formAddCourse.querySelector('.status');\r\n    let formData = new FormData();\r\n    let file = document\r\n      .querySelector('#file-select')\r\n      .files[0];\r\n    let name = document\r\n      .querySelector('#desc')\r\n      .value || 'course';\r\n  \r\n    formData.append('photo', file, file.name);\r\n    formData.append('name', name);\r\n  \r\n    resultContainer.innerHTML = 'Uploading...';\r\n    fileUpload('/courses/upload', formData, function (data) {      \r\n      resultContainer.innerHTML = data.status;\r\n      $(\"#img-holder\").attr(\"style\",`background-image:url(\"${data.url}\");`);\r\n      $(\"#img-holder\").attr('data-content','');\r\n      // formUpload.reset();\r\n    });\r\n  }\r\n\r\nfunction prepareSendCourse(e) {    \r\n  e.preventDefault();\r\n  let link = $(\"#img-holder\").css(\"background-image\").trim();   \r\n  let pic = link.substring(5, link.length - 2);  \r\n  let start = formAddCourse.start.value || new Date();\r\n  let end = formAddCourse.end.value || new Date();  \r\n\r\n  let data = {\r\n    picture: pic,\r\n    dateStart: start,\r\n    dateEnd: end,\r\n    name: formAddCourse.name.value,\r\n    desc: formAddCourse.desc.value\r\n  };\r\n  \r\n  prepareSend('/courses/addcourse', formAddCourse, data);\r\n}","import sendAjaxJson from './sendAjax';\r\n\r\nexport default function prepareSend(url, form, data, cb) {\r\n  let resultContainer = form.querySelector('.status');\r\n  resultContainer.innerHTML = 'Sending...';\r\n  sendAjaxJson(url, data, function (data) {\r\n    form.reset();\r\n    resultContainer.innerHTML = data;\r\n    if (cb) {\r\n      cb(data);\r\n    }\r\n  });\r\n}","export default function (url, data, cb) {\r\n  let xhr = new XMLHttpRequest();\r\n  xhr.open('POST', url, true);\r\n  xhr.setRequestHeader('Content-Type', 'application/json');\r\n  xhr.onload = function (e) {\r\n    let result;\r\n    try {\r\n      result = JSON.parse(xhr.responseText);\r\n    } catch (e) {\r\n      cb('Error');\r\n    }\r\n    cb(result.status);\r\n  };\r\n  xhr.send(JSON.stringify(data));\r\n}","export default function (url, data, cb) {\r\n  let xhr = new XMLHttpRequest();\r\n  xhr.open('POST', url, true);\r\n\r\n  xhr.onload = function (e) {\r\n    let result = JSON.parse(xhr.responseText);\r\n    cb(result.status);\r\n  };\r\n\r\n  xhr.send(data);\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzb3VyY2UvanMvY291cnNlcy5qcyIsInNvdXJjZS9qcy9wcmVwYXJlU2VuZC5qcyIsInNvdXJjZS9qcy9zZW5kQWpheC5qcyIsInNvdXJjZS9qcy91cGxvYWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU0sZ0JBQWdCLFNBQVMsYUFBVCxDQUF1QixhQUF2QixDQUF0QjtBQUNBLElBQU0sYUFBYSxTQUFTLGFBQVQsQ0FBdUIsY0FBdkIsQ0FBbkI7O0FBRUE7QUFDQSxFQUFHLFVBQUgsRUFBZ0IsTUFBaEIsQ0FBd0IsT0FBeEI7QUFDQSxFQUFFLGFBQUYsRUFBaUIsSUFBakIsQ0FBc0IsY0FBdEIsRUFBcUMsZ0JBQXJDO0FBQ0EsV0FBVyxnQkFBWCxDQUE0QixRQUE1QixFQUFzQyxVQUFVLENBQVYsRUFBYTtBQUFFLG1CQUFpQixDQUFqQixFQUFzQixnQkFBZ0IsQ0FBaEI7QUFBcUIsQ0FBaEc7QUFDQSxjQUFjLGdCQUFkLENBQStCLFFBQS9CLEVBQXlDLGlCQUF6QztBQUNBLGNBQWMsZ0JBQWQsQ0FBK0IsT0FBL0IsRUFBd0MsVUFBQyxDQUFELEVBQU87QUFBRSxnQkFBYyxLQUFkLENBQW9CLE9BQXBCLEdBQThCLE1BQTlCO0FBQXVDLENBQXhGOztBQUVBLFNBQVMsZ0JBQVQsQ0FBMEIsR0FBMUIsRUFBK0I7QUFDN0IsTUFBSSxJQUFJLElBQUksTUFBSixDQUFXLEtBQVgsQ0FBaUIsQ0FBakIsQ0FBUjtBQUNFLE1BQUksU0FBUyxJQUFJLFVBQUosRUFBYjtBQUNNLFNBQU8sTUFBUCxHQUFpQixVQUFTLE9BQVQsRUFBa0I7QUFDdkMsV0FBTyxVQUFTLENBQVQsRUFBWTtBQUNqQixRQUFFLGFBQUYsRUFBaUIsSUFBakIsQ0FBc0IsT0FBdEIsRUFBOEIsMkJBQXlCLEVBQUUsTUFBRixDQUFTLE1BQWxDLEdBQXlDLElBQXZF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QUNGLGVBQVMsS0FBSyxLQUFMLENBQVcsSUFBSSxZQUFmLENBQVQ7QUFDRCxLQUZELENBRUUsT0FBTyxDQUFQLEVBQVU7QUFDVixTQUFHLE9BQUg7QUFDRDtBQUNELE9BQUcsT0FBTyxNQUFWO0FBQ0QsR0FSRDtBQVNBLE1BQUksSUFBSixDQUFTLEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBVDtBQUNELEM7Ozs7Ozs7OztrQkNkYyxVQUFVLEdBQVYsRUFBZSxJQUFmLEVBQXFCLEVBQXJCLEVBQXlCO0FBQ3RDLE1BQUksTUFBTSxJQUFJLGNBQUosRUFBVjtBQUNBLE1BQUksSUFBSixDQUFTLE1BQVQsRUFBaUIsR0FBakIsRUFBc0IsSUFBdEI7O0FBRUEsTUFBSSxNQUFKLEdBQWEsVUFBVSxDQUFWLEVBQWE7QUFDeEIsUUFBSSxTQUFTLEtBQUssS0FBTCxDQUFXLElBQUksWUFBZixDQUFiO0FBQ0EsT0FBRyxPQUFPLE1BQVY7QUFDRCxHQUhEOztBQUtBLE1BQUksSUFBSixDQUFTLElBQVQ7QUFDRCxDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBmaWxlVXBsb2FkIGZyb20gJy4vdXBsb2FkJztcclxuaW1wb3J0IHByZXBhcmVTZW5kIGZyb20gJy4vcHJlcGFyZVNlbmQnO1xyXG5cclxuY29uc3QgZm9ybUFkZENvdXJzZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtY291cnNlJyk7XHJcbmNvbnN0IGZpbGVTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZmlsZS1zZWxlY3QnKTtcclxuXHJcbi8vIHRoaXMgaGFjayB0byBwcmV2ZW50IGRvdWJsZSBkYXRhIGluIGRiXHJcbiQoIFwiI2FkZC1idG5cIiApLnVuYmluZCggXCJjbGlja1wiICk7XHJcbiQoXCIjaW1nLWhvbGRlclwiKS5hdHRyKCdkYXRhLWNvbnRlbnQnLCdVcGxvYWQgcGljdHVyZScpO1xyXG5maWxlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7IGhhbmRsZUZpbGVTZWxlY3QoZSk7ICBwcmVwYXJlU2VuZEZpbGUoZSk7IH0pO1xyXG5mb3JtQWRkQ291cnNlLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHByZXBhcmVTZW5kQ291cnNlKTtcclxuZm9ybUFkZENvdXJzZS5hZGRFdmVudExpc3RlbmVyKCdyZXNldCcsIChlKSA9PiB7IGZvcm1BZGRDb3Vyc2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiOyB9KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZpbGVTZWxlY3QoZXZ0KSB7XHJcbiAgdmFyIGYgPSBldnQudGFyZ2V0LmZpbGVzWzBdO1xyXG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICByZWFkZXIub25sb2FkID0gKGZ1bmN0aW9uKHRoZUZpbGUpIHtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsgICAgICAgICAgXHJcbiAgICAgICAgJChcIiNpbWctaG9sZGVyXCIpLmF0dHIoXCJzdHlsZVwiLFwiYmFja2dyb3VuZC1pbWFnZTogdXJsKFwiK2UudGFyZ2V0LnJlc3VsdCtcIik7XCIpO1xyXG4gICAgICAgICQoXCIjaW1nLWhvbGRlclwiKS5hdHRyKCdkYXRhLWNvbnRlbnQnLCcnKTtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaW1nJywgZS50YXJnZXQucmVzdWx0KTtcclxuICAgICAgfTtcclxuICAgIH0pKGYpO1xyXG4gICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZik7ICAgIFxyXG59XHJcblxyXG5mdW5jdGlvbiBwcmVwYXJlU2VuZEZpbGUoZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0IHJlc3VsdENvbnRhaW5lciA9IGZvcm1BZGRDb3Vyc2UucXVlcnlTZWxlY3RvcignLnN0YXR1cycpO1xyXG4gICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICBsZXQgZmlsZSA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcjZmlsZS1zZWxlY3QnKVxyXG4gICAgICAuZmlsZXNbMF07XHJcbiAgICBsZXQgbmFtZSA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcjZGVzYycpXHJcbiAgICAgIC52YWx1ZSB8fCAnY291cnNlJztcclxuICBcclxuICAgIGZvcm1EYXRhLmFwcGVuZCgncGhvdG8nLCBmaWxlLCBmaWxlLm5hbWUpO1xyXG4gICAgZm9ybURhdGEuYXBwZW5kKCduYW1lJywgbmFtZSk7XHJcbiAgXHJcbiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MID0gJ1VwbG9hZGluZy4uLic7XHJcbiAgICBmaWxlVXBsb2FkKCcvY291cnNlcy91cGxvYWQnLCBmb3JtRGF0YSwgZnVuY3Rpb24gKGRhdGEpIHsgICAgICBcclxuICAgICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCA9IGRhdGEuc3RhdHVzO1xyXG4gICAgICAkKFwiI2ltZy1ob2xkZXJcIikuYXR0cihcInN0eWxlXCIsYGJhY2tncm91bmQtaW1hZ2U6dXJsKFwiJHtkYXRhLnVybH1cIik7YCk7XHJcbiAgICAgICQoXCIjaW1nLWhvbGRlclwiKS5hdHRyKCdkYXRhLWNvbnRlbnQnLCcnKTtcclxuICAgICAgLy8gZm9ybVVwbG9hZC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuZnVuY3Rpb24gcHJlcGFyZVNlbmRDb3Vyc2UoZSkgeyAgICBcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgbGV0IGxpbmsgPSAkKFwiI2ltZy1ob2xkZXJcIikuY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiKS50cmltKCk7ICAgXHJcbiAgbGV0IHBpYyA9IGxpbmsuc3Vic3RyaW5nKDUsIGxpbmsubGVuZ3RoIC0gMik7ICBcclxuICBsZXQgc3RhcnQgPSBmb3JtQWRkQ291cnNlLnN0YXJ0LnZhbHVlIHx8IG5ldyBEYXRlKCk7XHJcbiAgbGV0IGVuZCA9IGZvcm1BZGRDb3Vyc2UuZW5kLnZhbHVlIHx8IG5ldyBEYXRlKCk7ICBcclxuXHJcbiAgbGV0IGRhdGEgPSB7XHJcbiAgICBwaWN0dXJlOiBwaWMsXHJcbiAgICBkYXRlU3RhcnQ6IHN0YXJ0LFxyXG4gICAgZGF0ZUVuZDogZW5kLFxyXG4gICAgbmFtZTogZm9ybUFkZENvdXJzZS5uYW1lLnZhbHVlLFxyXG4gICAgZGVzYzogZm9ybUFkZENvdXJzZS5kZXNjLnZhbHVlXHJcbiAgfTtcclxuICBcclxuICBwcmVwYXJlU2VuZCgnL2NvdXJzZXMvYWRkY291cnNlJywgZm9ybUFkZENvdXJzZSwgZGF0YSk7XHJcbn0iLCJpbXBvcnQgc2VuZEFqYXhKc29uIGZyb20gJy4vc2VuZEFqYXgnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcHJlcGFyZVNlbmQodXJsLCBmb3JtLCBkYXRhLCBjYikge1xyXG4gIGxldCByZXN1bHRDb250YWluZXIgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5zdGF0dXMnKTtcclxuICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MID0gJ1NlbmRpbmcuLi4nO1xyXG4gIHNlbmRBamF4SnNvbih1cmwsIGRhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICBmb3JtLnJlc2V0KCk7XHJcbiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MID0gZGF0YTtcclxuICAgIGlmIChjYikge1xyXG4gICAgICBjYihkYXRhKTtcclxuICAgIH1cclxuICB9KTtcclxufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGNiKSB7XHJcbiAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gIHhoci5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcclxuICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcclxuICB4aHIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjYignRXJyb3InKTtcclxuICAgIH1cclxuICAgIGNiKHJlc3VsdC5zdGF0dXMpO1xyXG4gIH07XHJcbiAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKHVybCwgZGF0YSwgY2IpIHtcclxuICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgeGhyLm9wZW4oJ1BPU1QnLCB1cmwsIHRydWUpO1xyXG5cclxuICB4aHIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgY2IocmVzdWx0LnN0YXR1cyk7XHJcbiAgfTtcclxuXHJcbiAgeGhyLnNlbmQoZGF0YSk7XHJcbn0iXX0="}